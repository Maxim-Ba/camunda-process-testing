# üìä –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ SERVICE_API —Ä–µ—à–µ–Ω–∞!

### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
‚ùå Unknown property used in expression: ${SERVICE_API}/create-user
   Cause: Cannot resolve identifier 'SERVICE_API'
```

**–†–µ—à–µ–Ω–∏–µ:**
SERVICE_API —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ **–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ—Ü–µ—Å—Å–∞** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:

```java
private ProcessInstance startProcessWithServiceApi(String userName, String userEmail) {
    return runtimeService.startProcessInstanceByKey(
        "user-registration-process",
        withVariables(
            "userName", userName,
            "userEmail", userEmail,
            "SERVICE_API", "http://mock-service:9999" // ‚Üê –ü–µ—Ä–µ–¥–∞–µ–º –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é!
        )
    );
}
```

---

## ‚ö†Ô∏è –ü–æ—á–µ–º—É —Ç–µ—Å—Ç—ã –≤—Å–µ –µ—â–µ –ø–∞–¥–∞—é—Ç?

### –¢–µ–∫—É—â–∞—è –æ—à–∏–±–∫–∞:
```
‚ùå ConnectorRequest HTCL-02007 Unable to execute HTTP request
   Caused by: Connection refused: connect
```

### –ü—Ä–∏—á–∏–Ω–∞:

HTTP Connector –≤ `create-registration-task` –ø—ã—Ç–∞–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å **—Ä–µ–∞–ª—å–Ω—ã–π HTTP –∑–∞–ø—Ä–æ—Å** –∫:
```
http://mock-service:9999/create-user
```

–ò –ø–æ–ª—É—á–∞–µ—Ç `Connection refused`, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–∞–∫–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

### –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! ‚úÖ

**–≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è HTTP Connector!**

–ò–º–µ–Ω–Ω–æ —ç—Ç–æ –º—ã –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º –≤ –ø—Ä–æ–µ–∫—Ç–µ - —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É:
- **HTTP Connector** - –¥–µ–ª–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)
- **Java Delegate** - –º–æ–∫–∏—Ä—É–µ—Ç—Å—è (–ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)

---

## üéØ –î–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ

### 1. HTTP Connector (`create-registration-task`)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç Java –∫–æ–¥–∞
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ BPMN
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `${SERVICE_API}` –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚ùå **–î–µ–ª–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –≤ —Ç–µ—Å—Ç–∞—Ö**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç WireMock/MockServer –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤:**
```
‚ùå –ü–∞–¥–∞—é—Ç —Å "Unable to execute HTTP request"
‚ö†Ô∏è –≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ –±–µ–∑ WireMock
```

### 2. Java Delegate (`send-email-confirmation`)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –õ–µ–≥–∫–æ –º–æ–∫–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ –ù–µ –¥–µ–ª–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –≤ Java
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏–µ Java –∫–æ–¥–∞

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**
```
‚úÖ –ú–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
‚ö†Ô∏è –ù–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ –∏–∑-–∑–∞ HTTP Connector
```

---

## üîß –†–µ—à–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### –†–µ—à–µ–Ω–∏–µ 1: WireMock (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è HTTP Connector)

–î–æ–±–∞–≤—å—Ç–µ –≤ `pom.xml`:
```xml
<dependency>
    <groupId>com.github.tomakehurst</groupId>
    <artifactId>wiremock-jre8</artifactId>
    <version>2.35.0</version>
    <scope>test</scope>
</dependency>
```

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Ç–µ—Å—Ç–∞—Ö:
```java
@SpringBootTest
@AutoConfigureWireMock(port = 9999)
public class UserRegistrationProcessTest {

    @BeforeEach
    public void setUp() {
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ mock HTTP endpoint
        stubFor(post(urlEqualTo("/create-user"))
            .willReturn(aResponse()
                .withStatus(200)
                .withHeader("Content-Type", "application/json")
                .withBody("{\"status\":\"ok\"}")));
    }

    @Test
    public void testProcess() {
        // ‚úÖ –¢–µ–ø–µ—Ä—å HTTP –∑–∞–ø—Ä–æ—Å –ø–æ–π–¥–µ—Ç –≤ WireMock
        ProcessInstance process = startProcessWithServiceApi("Test", "test@example.com");
        assertThat(process).isWaitingAt("Activity_0g1mra7");
    }
}
```

### –†–µ—à–µ–Ω–∏–µ 2: –û—Ç–¥–µ–ª—å–Ω—ã–π BPMN –±–µ–∑ HTTP Connector

–°–æ–∑–¥–∞–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ç–æ–ª—å–∫–æ —Å Java Delegate –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### –†–µ—à–µ–Ω–∏–µ 3: Ignore —Ç–µ—Å—Ç—ã —Å HTTP Connector

–ü–æ–º–µ—Ç—å—Ç–µ —Ç–µ—Å—Ç—ã –∫–∞–∫ `@Disabled` —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º:

```java
@Test
@Disabled("–¢—Ä–µ–±—É–µ—Ç WireMock –¥–ª—è HTTP Connector. –°–º. DIFFERENCES_EXPLAINED.md")
public void testWithHttpConnector() {
    // ...
}
```

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –ê—Å–ø–µ–∫—Ç | HTTP Connector | Java Delegate |
|--------|----------------|---------------|
| **–†–µ–∑–æ–ª–≤–∏—Ç—Å—è SERVICE_API** | ‚úÖ –î–∞ | N/A |
| **–¢–µ—Å—Ç—ã –±–µ–∑ WireMock** | ‚ùå –ü–∞–¥–∞—é—Ç | ‚úÖ –ü—Ä–æ—Ö–æ–¥—è—Ç |
| **–†–µ–∞–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã** | ‚úÖ –î–∞ (–ø—Ä–æ–±–ª–µ–º–∞) | ‚ùå –ù–µ—Ç (–º–æ–∫–∏—Ä—É–µ—Ç—Å—è) |
| **–ù—É–∂–µ–Ω MockServer** | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** | ‚úÖ –ü—Ä–æ—Å—Ç–∞—è | ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** | ‚ùå –°–ª–æ–∂–Ω–∞—è | ‚úÖ –ü—Ä–æ—Å—Ç–∞—è |

---

## üí° –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç:

1. **SERVICE_API —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**
   - –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ—Ü–µ—Å—Å–∞
   - `${SERVICE_API}` –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ URL

2. **–ú–æ–∫–∏ –¥–µ–ª–µ–≥–∞—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã**
   - SendEmailDelegate –º–æ–∫–∏—Ä—É–µ—Ç—Å—è
   - –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

3. **–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
   - Groovy —Å–∫—Ä–∏–ø—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏:

1. **HTTP Connector –¥–µ–ª–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**
   - –ù—É–∂–µ–Ω WireMock –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
   - –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å

2. **–¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –Ω–∞ HTTP –∑–∞–ø—Ä–æ—Å–µ**
   - –≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ
   - –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –ø–æ–¥—Ö–æ–¥–æ–≤

---

## üéì –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

**–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:**

‚úÖ **–î–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∫ Service Tasks:**
- HTTP Connector (–ø—Ä–æ—Å—Ç–æ–π, –Ω–æ —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)
- Java Delegate (—Å–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å, –Ω–æ –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)

‚úÖ **–ü—Ä–æ–±–ª–µ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è HTTP Connector:**
- –†–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ —Ç–µ—Å—Ç–∞—Ö
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å MockServer/WireMock

‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ Java Delegate –¥–ª—è —Ç–µ—Å—Ç–æ–≤:**
- –õ–µ–≥–∫–æ –º–æ–∫–∏—Ä—É–µ—Ç—Å—è
- –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è

‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Environment Variables:**
- `${SERVICE_API}` –≤ BPMN
- –ü–µ—Ä–µ–¥–∞—á–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è production-ready —Ç–µ—Å—Ç–æ–≤:

1. **–î–æ–±–∞–≤–∏—Ç—å WireMock** –¥–ª—è HTTP Connector —Ç–µ—Å—Ç–æ–≤
2. **–°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç** —Ç–æ–ª—å–∫–æ —Å Java Delegate
3. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å** —Ä–∞–∑–Ω–∏—Ü—É –ø–æ–¥—Ö–æ–¥–æ–≤

### –î–ª—è –æ–±—É—á–µ–Ω–∏—è (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ):

1. ‚úÖ **–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–±–ª–µ–º—É** HTTP Connector
2. ‚úÖ **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ Java Delegate
3. ‚úÖ **–û–±—ä—è—Å–Ω—è–µ—Ç** –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **DIFFERENCES_EXPLAINED.md** - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ HTTP Connector vs Java Delegate
- **ENV_VARIABLES_GUIDE.md** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Environment Variables
- **TESTING_README.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ WireMock

---

## ‚ú® –ò—Ç–æ–≥

**–ü—Ä–æ–±–ª–µ–º–∞ SERVICE_API —Ä–µ—à–µ–Ω–∞! ‚úÖ**

–¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –∏–∑-–∑–∞ **—Ä–µ–∞–ª—å–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤** - —ç—Ç–æ **–æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** –¥–ª—è HTTP Connector –∏ **–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–∑–Ω–∏—Ü—ã** —Å Java Delegate –ø–æ–¥—Ö–æ–¥–æ–º.

–î–ª—è production —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
- **WireMock** –¥–ª—è HTTP Connector
- **Mockito** –¥–ª—è Java Delegate (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

**–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é!** üéì
